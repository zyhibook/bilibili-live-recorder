{"version":3,"file":"index.js","sources":["../share/index.js","../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../node_modules/@babel/runtime/helpers/createClass.js","dev/FLVParser.js","dev/MP4Parser.js","dev/index.js"],"sourcesContent":["export function getNowTime() {\n    if (performance && typeof performance.now === 'function') {\n        return performance.now();\n    }\n    return Date.now();\n}\n\nexport function sleep(ms = 0) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport function clamp(num, a, b) {\n    return Math.max(Math.min(num, Math.max(a, b)), Math.min(a, b));\n}\n\nexport function calculationRate(callback) {\n    let totalSize = 0;\n    let lastTime = getNowTime();\n    return size => {\n        totalSize += size;\n        const thisTime = getNowTime();\n        const diffTime = thisTime - lastTime;\n        if (diffTime >= 1000) {\n            callback((totalSize / diffTime) * 1000);\n            lastTime = thisTime;\n            totalSize = 0;\n        }\n    };\n}\n\nexport function mergeBuffer(...buffers) {\n    const Cons = buffers[0].constructor;\n    return buffers.reduce((pre, val) => {\n        const merge = new Cons((pre.byteLength | 0) + (val.byteLength | 0));\n        merge.set(pre, 0);\n        merge.set(val, pre.byteLength | 0);\n        return merge;\n    }, new Cons());\n}\n\nexport function download(url, name) {\n    const elink = document.createElement('a');\n    elink.style.display = 'none';\n    elink.href = url;\n    elink.download = name;\n    document.body.appendChild(elink);\n    elink.click();\n    document.body.removeChild(elink);\n}","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","export default class FlvParser {\n    constructor() {\n        this.data = new Uint8Array();\n    }\n\n    load() {\n        //\n    }\n\n    download() {\n        //\n    }\n}\n","export default class MP4Parser {\n    constructor() {\n        this.data = new Uint8Array();\n    }\n\n    load() {\n        //\n    }\n\n    download() {\n        //\n    }\n}\n","import { sleep } from '../../share';\nimport FLVParser from './FLVParser';\nimport MP4Parser from './MP4Parser';\n\nconst $script = document.createElement('script');\n$script.src = chrome.extension.getURL('injected/index.js');\n$script.onload = () => $script.remove();\n(document.head || document.body || document.documentElement).appendChild($script);\n\nconst $style = document.createElement('link');\n$style.rel = 'stylesheet';\n$style.type = 'text/css';\n$style.href = chrome.extension.getURL('injected/index.css');\nsleep().then(() => document.head.appendChild($style));\n\nconst flv = new FLVParser();\nconst mp4 = new MP4Parser();\nwindow.addEventListener('message', event => {\n    if (event.origin !== 'https://live.bilibili.com') return;\n    const { type, data } = event.data;\n    switch (type) {\n        case 'MP4Buffer':\n            mp4.load(data);\n            break;\n        case 'FLVBuffer':\n            flv.load(data);\n            break;\n        case 'MP4Download':\n            mp4.download();\n            break;\n        case 'FLVDownload':\n            flv.download();\n            break;\n        default:\n            break;\n    }\n});\n"],"names":["sleep","ms","Promise","resolve","setTimeout","FlvParser","data","Uint8Array","MP4Parser","$script","document","createElement","src","chrome","extension","getURL","onload","remove","head","body","documentElement","appendChild","$style","rel","type","href","then","flv","FLVParser","mp4","window","addEventListener","event","origin","load","download"],"mappings":"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"}