{"version":3,"file":"index.js","sources":["../../node_modules/@babel/runtime/helpers/classCallCheck.js","../share/index.js","../../node_modules/@babel/runtime/helpers/createClass.js","dev/FLVParser.js","dev/MP4Parser.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","export function getNowTime() {\n    if (performance && typeof performance.now === 'function') {\n        return performance.now();\n    }\n    return Date.now();\n}\n\nexport function sleep(ms = 0) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport function clamp(num, a, b) {\n    return Math.max(Math.min(num, Math.max(a, b)), Math.min(a, b));\n}\n\nexport function calculationRate(callback) {\n    let totalSize = 0;\n    let lastTime = getNowTime();\n    return size => {\n        totalSize += size;\n        const thisTime = getNowTime();\n        const diffTime = thisTime - lastTime;\n        if (diffTime >= 1000) {\n            callback((totalSize / diffTime) * 1000);\n            lastTime = thisTime;\n            totalSize = 0;\n        }\n    };\n}\n\nexport function mergeBuffer(...buffers) {\n    const Cons = buffers[0].constructor;\n    return buffers.reduce((pre, val) => {\n        const merge = new Cons((pre.byteLength | 0) + (val.byteLength | 0));\n        merge.set(pre, 0);\n        merge.set(val, pre.byteLength | 0);\n        return merge;\n    }, new Cons());\n}\n\nexport function download(url, name) {\n    const elink = document.createElement('a');\n    elink.style.display = 'none';\n    elink.href = url;\n    elink.download = name;\n    document.body.appendChild(elink);\n    elink.click();\n    document.body.removeChild(elink);\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","export default class FlvParser {\n    constructor() {\n        this.data = new Uint8Array();\n    }\n\n    load() {\n        //\n    }\n\n    download() {\n        //\n    }\n}\n","export default class MP4Parser {\n    constructor() {\n        this.data = new Uint8Array();\n    }\n\n    load() {\n        //\n    }\n\n    download() {\n        //\n    }\n}\n","import { sleep } from '../../share';\nimport FLVParser from './FLVParser';\nimport MP4Parser from './MP4Parser';\n\nclass Content {\n    constructor() {\n        const $script = document.createElement('script');\n        $script.src = chrome.extension.getURL('injected/index.js');\n        $script.onload = () => $script.remove();\n        (document.head || document.body || document.documentElement).appendChild($script);\n\n        const $style = document.createElement('link');\n        $style.rel = 'stylesheet';\n        $style.type = 'text/css';\n        $style.href = chrome.extension.getURL('injected/index.css');\n        sleep().then(() => document.head.appendChild($style));\n\n        const flv = new FLVParser();\n        const mp4 = new MP4Parser();\n        window.addEventListener('message', event => {\n            if (event.origin !== 'https://live.bilibili.com') return;\n            const { type, data } = event.data;\n            switch (type) {\n                case 'MP4Buffer':\n                    mp4.load(data);\n                    break;\n                case 'FLVBuffer':\n                    flv.load(data);\n                    break;\n                case 'MP4Download':\n                    mp4.download();\n                    break;\n                case 'FLVDownload':\n                    flv.download();\n                    break;\n                default:\n                    break;\n            }\n        });\n    }\n}\n\nexport default new Content();\n"],"names":["sleep","ms","Promise","resolve","setTimeout","FlvParser","data","Uint8Array","MP4Parser","Content","$script","document","createElement","src","chrome","extension","getURL","onload","remove","head","body","documentElement","appendChild","$style","rel","type","href","then","flv","FLVParser","mp4","window","addEventListener","event","origin","load","download"],"mappings":"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"}