{"version":3,"file":"index.js","sources":["../../node_modules/_csp-generator@1.0.2@csp-generator/dist/csp-generator.js","../../node_modules/_crx-hotreload@1.0.4@crx-hotreload/hot-reload.js","dev/index.js"],"sourcesContent":["/*!\n * csp-generator.js v1.0.2\n * Github: https://github.com/zhw2590582/csp-generator#readme\n * (c) 2017-2019 Harvey Zack\n * Released under the MIT License.\n */\n\n!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=e||self).CSP=t()}(this,function(){\"use strict\";var n=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")};function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var e=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};return function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\";n(this,t),this.csp=this.parse(e)}return e(t,[{key:\"parse\",value:function(e){return(0<arguments.length&&void 0!==e?e:\"\").split(\";\").reduce(function(e,t){var n=t.split(\" \").filter(function(e){return e.trim()}),i=n[0],r=n.slice(1);return e[i]=r,e},{})}},{key:\"generate\",value:function(){var n=this;return Object.keys(this.csp).reduce(function(e,t){return\"\".concat(e,\" \").concat(t,\" \").concat(n.csp[t].join(\" \"),\";\")},\"\").trim()}},{key:\"append\",value:function(e,t){return this.csp[e]&&-1===this.csp[e].indexOf(t)?this.csp[e].push(t):this.csp[e]=[t],this}},{key:\"delete\",value:function(e,t){if(t){var n=(this.csp[e]||[]).indexOf(t);-1<n&&this.csp[e].splice(n,1)}else delete this.csp[e];return this}},{key:\"get\",value:function(e){return this.csp[e]}}]),t}()});\n","const filesInDirectory = dir => new Promise (resolve =>\n\n    dir.createReader ().readEntries (entries =>\n\n        Promise.all (entries.filter (e => e.name[0] !== '.').map (e =>\n\n            e.isDirectory\n                ? filesInDirectory (e)\n                : new Promise (resolve => e.file (resolve))\n        ))\n        .then (files => [].concat (...files))\n        .then (resolve)\n    )\n)\n\nconst timestampForFilesInDirectory = dir =>\n        filesInDirectory (dir).then (files =>\n            files.map (f => f.name + f.lastModifiedDate).join ())\n\nconst reload = () => {\n\n    chrome.tabs.query ({ active: true, currentWindow: true }, tabs => { // NB: see https://github.com/xpl/crx-hotreload/issues/5\n\n        if (tabs[0]) { chrome.tabs.reload (tabs[0].id) }\n\n        chrome.runtime.reload ()\n    })\n}\n\nconst watchChanges = (dir, lastTimestamp) => {\n\n    timestampForFilesInDirectory (dir).then (timestamp => {\n\n        if (!lastTimestamp || (lastTimestamp === timestamp)) {\n\n            setTimeout (() => watchChanges (dir, timestamp), 1000) // retry after 1s\n\n        } else {\n\n            reload ()\n        }\n    })\n\n}\n\nchrome.management.getSelf (self => {\n\n    if (self.installType === 'development') {\n\n        chrome.runtime.getPackageDirectoryEntry (dir => watchChanges (dir))\n    }\n})\n","import CSP from 'csp-generator';\nimport 'crx-hotreload';\n\nconst manifest = chrome.runtime.getManifest();\nchrome.webRequest.onHeadersReceived.addListener(\n    details => {\n        const header = details.responseHeaders.find(event => {\n            const name = event.name.toLowerCase();\n            return name === 'content-security-policy-report-only' || name === 'content-security-policy';\n        });\n\n        if (header && header.value) {\n            const csp = new CSP(header.value);\n            csp.append('worker-src', 'blob:');\n            csp.append('script-src', '*.baidu.com');\n            csp.append('img-src', '*.baidu.com');\n            header.value = csp.generate();\n        }\n\n        return { responseHeaders: details.responseHeaders };\n    },\n    { urls: manifest.content_scripts[0].matches },\n    ['blocking', 'responseHeaders'],\n);\n"],"names":["this","manifest","chrome","runtime","getManifest","webRequest","onHeadersReceived","addListener","details","header","responseHeaders","find","event","name","toLowerCase","value","csp","CSP","append","generate","urls","content_scripts","matches"],"mappings":"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"}