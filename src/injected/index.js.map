{"version":3,"file":"index.js","sources":["../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../node_modules/@babel/runtime/helpers/createClass.js","../share/index.js","../../node_modules/@babel/runtime/helpers/defineProperty.js","../share/storage.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","export function sleep(ms = 0) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport function download(url, name) {\n    const elink = document.createElement('a');\n    elink.style.display = 'none';\n    elink.href = url;\n    elink.download = name;\n    document.body.appendChild(elink);\n    elink.click();\n    document.body.removeChild(elink);\n}\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export default class Storage {\n    constructor(name) {\n        this.name = name;\n    }\n\n    get(key) {\n        const storage = JSON.parse(window.localStorage.getItem(this.name)) || {};\n        return key ? storage[key] : storage;\n    }\n\n    set(key, value) {\n        const storage = { ...this.get(), [key]: value };\n        window.localStorage.setItem(this.name, JSON.stringify(storage));\n    }\n\n    del(key) {\n        const storage = this.get();\n        delete storage[key];\n        window.localStorage.setItem(this.name, JSON.stringify(storage));\n    }\n\n    clean() {\n        window.localStorage.removeItem(this.name);\n    }\n}\n","import './index.scss';\nimport { sleep, download } from '../../share';\nimport Storage from '../../share/storage';\n\nclass Injected {\n    constructor() {\n        this.name = 'bilibili-live-recorder';\n        this.storage = new Storage(this.name);\n        this.worker = new Worker('./worker.js');\n        this.loading = false;\n\n        this.worker.onmessage = event => {\n            const { type, data } = event.data;\n            switch (type) {\n                case 'report':\n                    this.$duration.textContent = data.duration;\n                    this.$size.textContent = data.size;\n                    break;\n                case 'download':\n                    download(data, `${document.title}.flv`);\n                    this.changeState('before-record');\n                    this.worker.terminate();\n                    this.$duration.textContent = '00:00';\n                    this.$size.textContent = '0.00M';\n                    break;\n                case 'error':\n                    this.loading = false;\n                    this.changeState('after-record');\n                    break;\n                default:\n                    break;\n            }\n        };\n\n        if (this.storage.get(location.href)) {\n            this.storage.del(location.href);\n            this.loading = true;\n            this.intercept();\n        }\n\n        sleep(1000).then(() => {\n            this.createUI();\n        });\n    }\n\n    // 创建UI\n    createUI() {\n        if (!document.body) {\n            return sleep(100).then(() => {\n                return this.createUI();\n            });\n        }\n\n        this.$container = document.createElement('div');\n        this.$container.classList.add(this.name);\n        this.$container.innerHTML = `\n            <div class=\"blr-states\">\n                <div class=\"blr-state blr-state-before-record blr-active\">开始</div>\n                <div class=\"blr-state blr-state-recording\">停止</div>\n                <div class=\"blr-state blr-state-after-record\">下载</div>\n                <div class=\"blr-state blr-state-wait\">稍等</div>\n            </div>\n            <div class=\"blr-monitors\">\n                <div class=\"blr-monitor blr-monitor-top\">\n                    <div class=\"blr-monitor-name\">时长：</div>\n                    <div class=\"blr-monitor-value blr-duration\">00:00</div>\n                </div>\n                <div class=\"blr-monitor blr-monitor-bottom\">\n                    <div class=\"blr-monitor-name\">大小：</div>\n                    <div class=\"blr-monitor-value blr-size\">0.00M</div>\n                </div>\n            </div>\n        `;\n        this.$states = Array.from(this.$container.querySelectorAll('.blr-state'));\n        this.$beforeRecord = this.$container.querySelector('.blr-state-before-record');\n        this.$recording = this.$container.querySelector('.blr-state-recording');\n        this.$afterRecord = this.$container.querySelector('.blr-state-after-record');\n        this.$duration = this.$container.querySelector('.blr-duration');\n        this.$size = this.$container.querySelector('.blr-size');\n        this.$monitor = this.$container.querySelector('.blr-monitor');\n\n        if (this.loading) {\n            this.changeState('recording');\n        } else if (location.href.includes('blr')) {\n            this.storage.clean();\n            this.$container.classList.add('blr-focus');\n            sleep(10000).then(() => {\n                this.$container.classList.remove('blr-focus');\n            });\n        }\n\n        const x = this.storage.get('x');\n        const y = this.storage.get('y');\n        if (x && y) {\n            this.$container.style.left = `${x}px`;\n            this.$container.style.top = `${y}px`;\n        }\n\n        document.body.appendChild(this.$container);\n        this.bindEvent();\n    }\n\n    // 更改状态\n    changeState(state) {\n        this.$states.forEach(item => {\n            if (item.classList.contains(`blr-state-${state}`)) {\n                item.classList.add('blr-active');\n            } else {\n                item.classList.remove('blr-active');\n            }\n        });\n    }\n\n    // 绑定事件\n    bindEvent() {\n        this.$beforeRecord.addEventListener('click', () => {\n            const $video = document.querySelector('video');\n            if ($video) {\n                this.storage.set(location.href, Date.now());\n                location.reload();\n            }\n        });\n\n        this.$recording.addEventListener('click', () => {\n            this.loading = false;\n            this.changeState('after-record');\n            this.worker.postMessage({\n                type: 'stop',\n            });\n        });\n\n        this.$afterRecord.addEventListener('click', () => {\n            this.loading = false;\n            this.changeState('wait');\n            this.worker.postMessage({\n                type: 'download',\n            });\n        });\n\n        let isDroging = false;\n        let lastPageX = 0;\n        let lastPageY = 0;\n        let lastPlayerLeft = 0;\n        let lastPlayerTop = 0;\n\n        this.$monitor.addEventListener('mousedown', () => {\n            isDroging = true;\n            lastPageX = event.pageX;\n            lastPageY = event.pageY;\n            lastPlayerLeft = this.$container.offsetLeft;\n            lastPlayerTop = this.$container.offsetTop;\n        });\n\n        document.addEventListener('mousemove', event => {\n            if (isDroging) {\n                const x = event.pageX - lastPageX;\n                const y = event.pageY - lastPageY;\n                this.$container.style.transform = `translate(${x}px, ${y}px)`;\n            }\n        });\n\n        document.addEventListener('mouseup', () => {\n            if (isDroging) {\n                isDroging = false;\n                this.$container.style.transform = 'translate(0, 0)';\n                const x = lastPlayerLeft + event.pageX - lastPageX;\n                const y = lastPlayerTop + event.pageY - lastPageY;\n                this.$container.style.left = `${x}px`;\n                this.$container.style.top = `${y}px`;\n                this.storage.set('x', x);\n                this.storage.set('y', y);\n            }\n        });\n    }\n\n    // 拦截视频流\n    intercept() {\n        const { read } = ReadableStreamDefaultReader.prototype;\n        const that = this;\n        ReadableStreamDefaultReader.prototype.read = function() {\n            const promiseResult = read.call(this);\n            promiseResult.then(({ done, value }) => {\n                if (done || !that.loading) return;\n                that.worker.postMessage({\n                    type: 'load',\n                    data: value,\n                });\n            });\n            return promiseResult;\n        };\n    }\n}\n\nexport default new Injected();\n"],"names":["sleep","ms","Promise","resolve","setTimeout","download","url","name","elink","document","createElement","style","display","href","body","appendChild","click","removeChild","Storage","key","storage","JSON","parse","window","localStorage","getItem","value","get","setItem","stringify","removeItem","Injected","worker","Worker","URL","loading","onmessage","event","data","type","$duration","textContent","duration","$size","size","title","changeState","terminate","location","del","intercept","then","createUI","$container","classList","add","innerHTML","$states","Array","from","querySelectorAll","$beforeRecord","querySelector","$recording","$afterRecord","$monitor","includes","clean","remove","x","y","left","top","bindEvent","state","forEach","item","contains","addEventListener","$video","set","Date","now","reload","postMessage","isDroging","lastPageX","lastPageY","lastPlayerLeft","lastPlayerTop","pageX","pageY","offsetLeft","offsetTop","transform","read","ReadableStreamDefaultReader","prototype","that","promiseResult","call","done"],"mappings":"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"}