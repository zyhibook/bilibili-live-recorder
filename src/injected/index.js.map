{"version":3,"file":"index.js","sources":["../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../node_modules/@babel/runtime/helpers/createClass.js","../share/constant.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","// 常用地址\nexport const BILIBILI = 'https://live.bilibili.com';\nexport const BILIBILI_PATTERN = '*://*.bilibili.com/*';\nexport const GITHUB = 'https://github.com/zhw2590582/bilibili-live-recorder';\nexport const WEBSTORE = 'https://chrome.google.com/webstore/category/extensions';\n\n// 状态\nexport const BEFORE_RECORD = 'before_record';\nexport const RECORDING = 'recording';\nexport const AFTER_RECORD = 'after_record';\nexport const BEFORE_DOWNLOAD = 'before_download';\nexport const DOWNLOADING = 'downloading';\nexport const AFTER_DOWNLOAD = 'after_download';\n\n// 动作\nexport const START_RECORD = 'start_record';\nexport const STOP_RECORD = 'stop_record';\nexport const START_DOWNLOAD = 'start_download';\nexport const UPDATE_CONFIG = 'update_config';\nexport const MP4_BUFFER = 'mp4_buffer';\nexport const FLV_BUFFER = 'flv_buffer';\n\n// 语言\nexport const TITLE_REPLACE = ' - 哔哩哔哩直播，二次元弹幕直播平台';\nexport const OPEN_LIVE = '请先打开Bilibili直播间';\nexport const RECORD_CREATED = '录制任务创建成功';\nexport const RECORD_STOP = '录制任务已经停止';\nexport const RECORD_DOWNLOAD = '录制文件开始下载';\nexport const FILE_NAME = '请输入文件名称';\n","import './index.scss';\nimport { MP4_BUFFER, FLV_BUFFER } from '../../share/constant';\n\nclass Injected {\n    constructor() {\n        this.proxyRead();\n    }\n\n    proxyRead() {\n        const { read } = ReadableStreamDefaultReader.prototype;\n        ReadableStreamDefaultReader.prototype.read = function() {\n            const promiseResult = read.call(this);\n            promiseResult.then(({ done, value }) => {\n                if (done) return;\n                window.postMessage({\n                    type: FLV_BUFFER,\n                    data: value.slice(),\n                });\n            });\n            return promiseResult;\n        };\n    }\n\n    proxyAppendBuffer() {\n        const { appendBuffer } = SourceBuffer.prototype;\n        SourceBuffer.prototype.appendBuffer = function(buf) {\n            window.postMessage({\n                type: MP4_BUFFER,\n                data: new Uint8Array(buf.slice()),\n            });\n            return appendBuffer.call(this, buf);\n        };\n    }\n}\n\nexport default new Injected();\n"],"names":["MP4_BUFFER","FLV_BUFFER","Injected","proxyRead","read","ReadableStreamDefaultReader","prototype","promiseResult","call","then","done","value","window","postMessage","type","data","slice","appendBuffer","SourceBuffer","buf","Uint8Array"],"mappings":";;;;;;EAAA,SAAS,eAAe,CAAC,QAAQ,EAAE,WAAW,EAAE;IAC9C,IAAI,EAAE,QAAQ,YAAY,WAAW,CAAC,EAAE;MACtC,MAAM,IAAI,SAAS,CAAC,mCAAmC,CAAC,CAAC;KAC1D;GACF;;EAED,kBAAc,GAAG,eAAe;;ECNhC,SAAS,iBAAiB,CAAC,MAAM,EAAE,KAAK,EAAE;IACxC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACrC,IAAI,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;MAC1B,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,IAAI,KAAK,CAAC;MACvD,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC;MAC/B,IAAI,OAAO,IAAI,UAAU,EAAE,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;MACtD,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,UAAU,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;KAC3D;GACF;;EAED,SAAS,YAAY,CAAC,WAAW,EAAE,UAAU,EAAE,WAAW,EAAE;IAC1D,IAAI,UAAU,EAAE,iBAAiB,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;IACrE,IAAI,WAAW,EAAE,iBAAiB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;IAC7D,OAAO,WAAW,CAAC;GACpB;;EAED,eAAc,GAAG,YAAY;;EChB7B;AACA,EAkBO,IAAMA,UAAU,GAAG,YAAnB;AACP,EAAO,IAAMC,UAAU,GAAG,YAAnB;;MCjBDC;;;EACF,sBAAc;EAAA;;EACV,SAAKC,SAAL;EACH;;;;kCAEW;EAAA,UACAC,IADA,GACSC,2BAA2B,CAACC,SADrC,CACAF,IADA;;EAERC,MAAAA,2BAA2B,CAACC,SAA5B,CAAsCF,IAAtC,GAA6C,YAAW;EACpD,YAAMG,aAAa,GAAGH,IAAI,CAACI,IAAL,CAAU,IAAV,CAAtB;EACAD,QAAAA,aAAa,CAACE,IAAd,CAAmB,gBAAqB;EAAA,cAAlBC,IAAkB,QAAlBA,IAAkB;EAAA,cAAZC,KAAY,QAAZA,KAAY;EACpC,cAAID,IAAJ,EAAU;EACVE,UAAAA,MAAM,CAACC,WAAP,CAAmB;EACfC,YAAAA,IAAI,EAAEb,UADS;EAEfc,YAAAA,IAAI,EAAEJ,KAAK,CAACK,KAAN;EAFS,WAAnB;EAIH,SAND;EAOA,eAAOT,aAAP;EACH,OAVD;EAWH;;;0CAEmB;EAAA,UACRU,YADQ,GACSC,YAAY,CAACZ,SADtB,CACRW,YADQ;;EAEhBC,MAAAA,YAAY,CAACZ,SAAb,CAAuBW,YAAvB,GAAsC,UAASE,GAAT,EAAc;EAChDP,QAAAA,MAAM,CAACC,WAAP,CAAmB;EACfC,UAAAA,IAAI,EAAEd,UADS;EAEfe,UAAAA,IAAI,EAAE,IAAIK,UAAJ,CAAeD,GAAG,CAACH,KAAJ,EAAf;EAFS,SAAnB;EAIA,eAAOC,YAAY,CAACT,IAAb,CAAkB,IAAlB,EAAwBW,GAAxB,CAAP;EACH,OAND;EAOH;;;;;;AAGL,cAAe,IAAIjB,QAAJ,EAAf;;;;;;;;"}