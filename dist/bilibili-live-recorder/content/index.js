/*!
 * bilibili-live-recorder v1.0.0
 * Github: undefined
 * (c) 2018-2019 Harvey Zack
 * Released under the MIT License.
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Content=t()}(this,(function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var n=function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e};var a="https://live.bilibili.com",r="tab_info",o="start_record",i="stop_record",s="start_download",c="mp4_buffer",d="flv_buffer";return new(function(){function t(){var n=this;e(this,t),this.injectScript(),this.injectStyle(),this.tab=null,this.config=null,this.worker=new Worker(URL.createObjectURL(new Blob(['"use strict";var FLV_BUFFER="flv_buffer",START_RECORD="start_record",START_DOWNLOAD="start_download",STOP_RECORD="stop_record";onmessage=function onmessage(a){var b=a.data,c=b.type,d=b.data;switch(c){case FLV_BUFFER:break;case START_DOWNLOAD:break;case START_RECORD:break;case STOP_RECORD:break;default:}};']))),this.worker.onmessage=function(e){var t=e.data;t.type,t.data},chrome.runtime.onMessage.addListener((function(e,t,a){var c=e.type,d=e.data;switch(c){case r:n.tab=d;break;case o:n.config=d,n.worker.postMessage({type:o,data:d});break;case s:n.config=d,n.worker.postMessage({type:s,data:d});break;case i:n.config=d,n.worker.postMessage({type:i,data:d})}a(n.config)})),window.addEventListener("message",(function(e){if(e.origin===a){var t=e.data,r=t.type,o=t.data;switch(r){case c:break;case d:n.worker.postMessage({type:d,data:o})}}}))}return n(t,[{key:"injectScript",value:function(){var e=document.createElement("script");e.src=chrome.extension.getURL("injected/index.js"),e.onload=function(){return e.remove()},document.documentElement.appendChild(e)}},{key:"injectStyle",value:function(){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=chrome.extension.getURL("injected/index.css"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}().then((function(){return document.head.appendChild(e)}))}}]),t}())}));
